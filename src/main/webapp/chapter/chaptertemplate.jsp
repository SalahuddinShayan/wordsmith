<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0D3MMVLTED"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0D3MMVLTED');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3020770276580291" crossorigin="anonymous"></script>
<meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="google-adsense-account" content="ca-pub-3020770276580291">
        <meta name="keywords" content="${chapter.keywords}">
        <title>${chapter.novelName}-Chapter ${chapter.chapterNo}</title>
        <link rel="icon" type="image/x-icon" href="../images/logo2.png">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" >
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" >
        <style><%@include file="../css/stylesheet.css"%></style>
         <%@ taglib uri="http://www.springframework.org/tags/form" prefix="form"%>    
		 <%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
		 <%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
		 <script data-grow-initializer="">!(function(){window.growMe||((window.growMe=function(e){window.growMe._.push(e);}),(window.growMe._=[]));var e=document.createElement("script");(e.type="text/javascript"),(e.src="https://faves.grow.me/main.js"),(e.defer=!0),e.setAttribute("data-grow-faves-site-id","U2l0ZTpjMzAxMTE4Mi1jZDdlLTRiYTMtOTkxNy1lMDZhMThiOGFiMjE=");var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t);})();</script>
</head>
<body onload="ChapStyle()">

<%@ include file="../nav2.jsp" %>



        <!-- Conversant Media CODE for Eastern Wordsmith (Placement 953273c1) -->
          <div class="d-block d-lg-none text-center my-3" id="pubCodeContainer-id-245979-953273c1">
            <script type="text/javascript"
              src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
            <script>
              conversant.pubcode.loadOneAd({
                sid: 245979,
                id: "953273c1",
                location: "pubCodeContainer-id-245979-953273c1",
                format: [{ w: 320, h: 100 }]
              })
            </script>
          </div>
          <!-- Conversant Media CODE for Eastern Wordsmith (Placement 953273c1) -->


	<!-- Conversant Media CODE for Eastern Wordsmith (Placement fdb866a2) -->
	<div class="d-none d-lg-block text-center my-3" id="pubCodeContainer-id-245979-fdb866a2">
		<script type="text/javascript"
			src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
		<script>
        conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "fdb866a2",
            location: "pubCodeContainer-id-245979-fdb866a2",
            format: [{w:970,h:250}]
        })
    </script>
	</div>
	<!-- Conversant Media CODE for Eastern Wordsmith (Placement fdb866a2) -->
        
        <div class= "center">
        <h3>${chapter.novelName}-Chapter ${chapter.chapterNo}</h3>
        <h3>${chapter.title}</h3>
        </div>
        
         <div  Style = "margin-top: 30px;" class = "row">
         <div class="col-1 col-lg-2 py-3"></div>
         <div class="col-10 col-lg-8 py-3 stm"><a href ="../home">Eastern Word Smith</a><a>/</a><a  href="../novel/${chapter.novelName}">${chapter.novelName}</a><a>/</a><a  href = "${chapter.chapterId}">Chapter ${chapter.chapterNo}</a></div>
         <div class="col-1 col-lg-2 py-3"></div>
         </div>
         
        <div  Style = "margin-top: 30px;" class = "row">
        	<div class="col-1 col-lg-2 py-3 "></div>
        	<div class="col-10 col-lg-8 bd-az">
        	<h5>Update:</h5> 
        	<p>Hey guys,<br>
        	   As most of you probably know by now Disqus has stopped providing services to many sites and our site is one of them. Right now, 
        	   we are in the middle of developing our independent comment system. As of today(26 March 2025), we are releasing the comment with 
        	   Limited features. There are other features still under development and may take some time to roll out.
        	</p>
        	<p>As always, please continue to support us. You can show your support in the following ways:
        	</p> 
        	<ul> 
        	<li><strong>Bookmark and Rate Your Favorite Novel:</strong> Head over to Novel Updates, bookmark your favorite stories, rate them, and leave a review. This simple action boosts our visibility and helps us reach more readers like you.</li> 
        	<li><strong>Engage with Our Chapters:</strong> After reading a chapter, please leave a comment or reaction. Your feedback not only lets us know youâ€™re enjoying the story, but it also keeps us motivated.</li> 
        	<li><strong>Support Us on Ko-fi:</strong> As a small operation, we rely on your support to cover our costs. If you can, please consider donating on Ko-fi. Even a small contribution makes a huge difference!</li> 
        	<li><strong>Help Us Improve the Website:</strong> Since weâ€™re still in the early stages, weâ€™d love your feedback on the websiteâ€™s navigation, design, and user experience. What do you like? What could be better? Are there any features you'd like to see? Share your thoughts with us via the Contact Us form. Your insights are incredibly valuable to us!</li>
        	<li><strong>Do not use Ad-Blocker:</strong> Please know that ads are our only source of revenue right now.</li> 
        	</ul> 
        	
        	
        	</div>
        	<div class="col-1 col-lg-2 py-3 "></div>
        </div>
        
        <!-- Conversant Media CODE for Eastern Wordsmith (Placement d3468b89) -->
			<div class="text-center my-3" id="pubCodeContainer-id-245979-d3468b89">
				<script type="text/javascript"
					src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
				<script>
        conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "d3468b89",
            location: "pubCodeContainer-id-245979-d3468b89",
            format: [{w:300,h:250}]
        })
    </script>
			</div>
			<!-- Conversant Media CODE for Eastern Wordsmith (Placement d3468b89) -->
			
			<!-- Conversant Media CODE for Eastern Wordsmith (Placement efe28409) -->
          <div class="text-center my-3" id="pubCodeContainer-id-245979-efe28409">
            <script type="text/javascript"
              src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
            <script>
              conversant.pubcode.loadOneAd({
                sid: 245979,
                id: "efe28409",
                location: "pubCodeContainer-id-245979-efe28409",
                format: [{ w: 728, h: 90 }]
              })
            </script>
          </div>
          <!-- Conversant Media CODE for Eastern Wordsmith (Placement efe28409) -->
        
         <div  Style = "margin-top: 30px;" class = "row">
         <div class="col-1 col-lg-2 d-none d-md-block py-3">
         	  <div class = "sticky-ad">
         	  <!-- Conversant Media CODE for Eastern Wordsmith (Placement 2964d05d) -->
              <div class="d-none d-lg-block text-center my-3" id="pubCodeContainer-id-245979-2964d05d">
                <script type="text/javascript"
                  src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
                <script>
                  conversant.pubcode.loadOneAd({
                    sid: 245979,
                    id: "2964d05d",
                    location: "pubCodeContainer-id-245979-2964d05d",
                    format: [{ w: 160, h: 600 }]
                  })
                </script>
              </div>
              <!-- Conversant Media CODE for Eastern Wordsmith (Placement 2964d05d) -->

			<!-- Conversant Media CODE for Eastern Wordsmith (Placement 210e6523) -->
			<div class="d-none d-lg-block text-center my-3" id="pubCodeContainer-id-245979-210e6523">
				<script type="text/javascript"
					src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
				<script>
        conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "210e6523",
            location: "pubCodeContainer-id-245979-210e6523",
            format: [{w:300,h:600}]
        })
    </script>
			</div>
			<!-- Conversant Media CODE for Eastern Wordsmith (Placement 210e6523) -->
			</div>
         </div>
         <div class="col-12 col-lg-8 py-3">
         <div class ="center">
         <a id="DMS" onclick="lightSwitch()" ><img class ="icon" alt="" src="../images/moon.png"></a>
         <a id="Minus" onclick="TextSizeDecrease()" ><img class ="icon" alt="" src="../images/minus.png"></a>
         <a id="Default" onclick="TextSizeDefault()" ><img class ="icon" alt="" src="../images/alpha.png"></a>
         <a id="Plus" onclick="TextSizeIncrease()" ><img class ="icon" alt="" src="../images/plus-sign.png"></a>
         <a href="../chapter-previous/${chapter.chapterId}"><img class ="icon" alt="" src="../images/arrow-left.png"></a>
         <a href="../novel/${chapter.novelName}"><img class ="icon" alt="" src="../images/home.png"></a>
         <a href="../chapter-next/${chapter.chapterId}"><img class ="icon" alt="" src="../images/right-arrow.png"></a>
         </div>
         <section class ="wcontainer" id="CS">
         ${chapter.content}
         </section>
         <div class ="center">
         <a id="DMS" onclick="lightSwitch()" ><img class ="icon" alt="" src="../images/moon.png"></a>
         <a id="Minus" onclick="TextSizeDecrease()" ><img class ="icon" alt="" src="../images/minus.png"></a>
         <a id="Default" onclick="TextSizeDefault()" ><img class ="icon" alt="" src="../images/alpha.png"></a>
         <a id="Plus" onclick="TextSizeIncrease()" ><img class ="icon" alt="" src="../images/plus-sign.png"></a>
         <a href="../chapter-previous/${chapter.chapterId}"><img class ="icon" alt="" src="../images/arrow-left.png"></a>
         <a href="../novel/${chapter.novelName}"><img class ="icon" alt="" src="../images/home.png"></a>
         <a href="../chapter-next/${chapter.chapterId}"><img class ="icon" alt="" src="../images/right-arrow.png"></a><br><br><br>
         <p><script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Support Us on Ko-fi', '#1F8FFF', 'Y8Y2163B9B');kofiwidget2.draw();</script></p> 
         </div>
         </div>
         <div class="col-1 col-lg-2 d-none d-md-block py-3">
			<!-- Conversant Media CODE for Eastern Wordsmith (Placement 1d89bbaf) -->
			<div class="d-none d-lg-block text-center my-3 sticky-ad" id="pubCodeContainer-id-245979-1d89bbaf">
				<script type="text/javascript"
					src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
				<script>
        conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "1d89bbaf",
            location: "pubCodeContainer-id-245979-1d89bbaf",
            format: [{w:300,h:1050}]
        })
    </script>
			</div>
			<!-- Conversant Media CODE for Eastern Wordsmith (Placement 1d89bbaf) -->

		</div>
         </div>

	<!-- Conversant Media CODE for Eastern Wordsmith (Placement ce1af472) -->
	<div class="text-center my-4" id="pubCodeContainer-id-245979-ce1af472">
		<script type="text/javascript"
			src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
		<script>
        conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "ce1af472",
            location: "pubCodeContainer-id-245979-ce1af472",
            format: [{w:336,h:280}]
        })
    </script>
	</div>
	<!-- Conversant Media CODE for Eastern Wordsmith (Placement ce1af472) -->

        
        <div  Style = "margin-top: 30px;" class = "row">
         <div class="col-1 col-lg-3 py-3 "></div>
         <div class="col-10 col-lg-6 py-3 ">
         <div class="comments-section" id="comment">
    <h3>Comments</h3>

    <div class= "cbox">
    <div class="">
    <!-- ðŸ”¹ Show login prompt if the user is not logged in -->
    <c:if test="${empty loggedInUser}">
        <p>You must <a href="/auth/loginpage">log in</a> to post a comment.</p>
    </c:if>

    <!-- ðŸ”¹ Show comment form if the user is logged in -->
    <c:if test="${not empty loggedInUser}">
        <form action="/comments/add" method="post">
            <input type="hidden" name="entityType" value="chapter">
            <input type="hidden" name="entityId" value="${chapter.chapterId}">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
            <textarea name="content" required class="form-control" placeholder="Write a comment..."></textarea>
            <button type="submit" class="btn btn-primary mt-2">Comment</button>
        </form>
    </c:if>
    </div>
    
    <br>


    <!-- ðŸ”¹ Display Comments and Nested Replies -->
    <c:forEach var="comment" items="${comments}">
        <div class="comment">
            <strong>${comment.userName}</strong>
            <small>${comment.timeAgo}</small>
            <p>${comment.content}</p>
            
            

            
            
            <!-- ðŸ”¹ Buttons for Delete, Flag, and Reply (Now in the same row) -->
            <div class="comment-actions">
                <c:if test="${loggedInUser.username == comment.userName || loggedInUser.role == 'ADMIN'}">
                    <form action="/comments/delete" method="post" class="comment-action-form">
                        <input type="hidden" name="commentId" value="${comment.id}">
                        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
                        <button type="submit" class="icon-btn"><i class="fa-solid fa-trash"></i></button>
                    </form>
                </c:if>

                
                <form action="/comments/flag" method="post" class="comment-action-form">
                    <input type="hidden" name="commentId" value="${comment.id}">
                    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
                    <button type="submit" class="icon-btn"><i class="fa-solid fa-flag"></i></button>
                </form>

                <!--<c:if test="${not empty loggedInUser}">
                    <button class="icon-btn reply-btn" onclick="toggleReplyForm('${comment.id}')">
                        <i class="fa-solid fa-reply"></i>
                    </button>
                </c:if>-->
            </div>

            <!-- ðŸ”¹ Display Replies (Nested Comments) -->
            <!--<c:if test="${comment.hasReplies}">
                <div class="replies" style="margin-left: 30px;">
                    <c:forEach var="reply" items="${comment.replies}">
                        <div class="comment">
                            <strong>${reply.user.username}</strong>
                            <p>${reply.content}</p>
                            <small>Posted on: ${reply.createdAt}</small>

                            <c:if test="${loggedInUser.id == reply.user.id || loggedInUser.role == 'ADMIN'}">
                                <form action="/comments/delete" method="post">
                                    <input type="hidden" name="commentId" value="${reply.id}">
                                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                </form>
                            </c:if>

                            <form action="/comments/flag" method="post">
                                <input type="hidden" name="commentId" value="${reply.id}">
                                <button type="submit" class="btn btn-warning btn-sm">Flag</button>
                            </form>
                        </div>
                    </c:forEach>
                </div>
            </c:if>-->
        </div>
        <br>
    </c:forEach>
</div>
</div>
         </div>
         <div class="col-1 col-lg-3 py-3 "></div>
         </div>
         
         <!-- Conversant Media CODE for Eastern Wordsmith (Placement e1f0d2e7) -->
      <div class="d-block text-center my-4" id="pubCodeContainer-id-245979-e1f0d2e7">
        <script type="text/javascript"
          src="https://secure.cdn.fastclick.net/js/cnvr-pubcode/latest/pubcode.min.js"></script>
        <script>
          conversant.pubcode.loadOneAd({
            sid: 245979,
            id: "e1f0d2e7",
            location: "pubCodeContainer-id-245979-e1f0d2e7",
            format: [{ w: 320, h: 50 }]
          })
        </script>
      </div>
      <!-- Conversant Media CODE for Eastern Wordsmith (Placement e1f0d2e7) -->
        
        <%@ include file="../footer2.jsp" %>
       
     
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" ></script>
<script type="text/javascript" src="../js/script.js"></script>  
</body>
</html>